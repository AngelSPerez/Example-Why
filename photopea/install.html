<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instalador de WhyStore</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#121212">
    <link rel="apple-touch-icon" href="images/icons/icon-192x192.png">

    <style>
        :root{--bg-color:#121212;--surface-color:rgba(30,30,30,0.7);--primary-color:#0d6efd;--primary-hover:#0b5ed7;--text-color:#e0e0e0;--text-secondary:#a0a0a0;--font-stack:system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif}body,html{margin:0;padding:0;height:100%;overflow:hidden;font-family:var(--font-stack);background-color:var(--bg-color);background-image:radial-gradient(circle at 10% 20%,rgba(100,100,255,0.1),transparent 30%),radial-gradient(circle at 80% 90%,rgba(255,100,100,0.1),transparent 30%);color:var(--text-color)}.card-container{display:flex;justify-content:center;align-items:center;height:100%;padding:20px;box-sizing:border-box}.install-card{background:var(--surface-color);border:1px solid rgba(255,255,255,0.1);border-radius:20px;padding:40px;text-align:center;box-shadow:0 8px 32px 0 rgba(0,0,0,0.37);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);max-width:400px;animation:fadeIn .8s ease-in-out}.app-icon{width:100px;height:100px;border-radius:24px;box-shadow:0 4px 15px rgba(0,0,0,0.2)}h1{font-size:2.2rem;margin:20px 0 5px}#status-text{font-size:1.2rem;color:var(--text-secondary);font-weight:300;height:25px;display:flex;align-items:center;justify-content:center;gap:10px}.instructions{color:var(--text-secondary);margin-top:20px;line-height:1.6}#install-prompt{display:none;position:fixed;top:15px;right:80px;background-color:#282828;color:#fff;padding:15px 20px;border-radius:12px;box-shadow:0 4px 15px rgba(0,0,0,0.5);z-index:1000;align-items:center;gap:15px;animation:fadeInDown .5s}#install-prompt::after{content:'';position:absolute;top:-10px;right:25px;border-left:10px solid transparent;border-right:10px solid transparent;border-bottom:10px solid #282828}#install-button{background-color:var(--primary-color);color:#fff;border:none;padding:8px 15px;border-radius:8px;cursor:pointer;font-weight:700;font-size:14px;transition:background-color .2s}#install-button:hover{background-color:var(--primary-hover)}.loader{border:4px solid rgba(255,255,255,0.2);border-radius:50%;border-top:4px solid #fff;width:20px;height:20px;animation:spin 1s linear infinite}.modal-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.7);display:none;justify-content:center;align-items:center;z-index:2000}.modal-content{background-color:#282828;padding:25px;border-radius:16px;width:90%;max-width:320px;box-shadow:0 5px 15px rgba(0,0,0,0.5);text-align:left;animation:fadeIn .5s}.modal-content h2{font-size:18px;margin-top:0;margin-bottom:15px;color:var(--text-color)}.modal-content p{margin:0;line-height:1.5;font-size:15px;color:var(--text-secondary)}.modal-content .step{display:flex;align-items:center;margin-top:15px}.modal-content .step-number{background-color:#444;border-radius:50%;width:24px;height:24px;display:inline-flex;justify-content:center;align-items:center;font-weight:700;margin-right:12px;flex-shrink:0}.modal-content .three-dots{font-weight:700;font-size:20px;vertical-align:middle}@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}@keyframes fadeIn{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}@keyframes fadeInDown{from{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}
    </style>
</head>
<body>
    
    <div id="pwa-modal" class="modal-overlay">
        <div class="modal-content">
            <h2>Ultimos pasos</h2>
            <p>Para continuar, por favor sigue las instrucciones.</p>
            <div class="step">
                <span class="step-number">1</span>
                <span>Toca el menú <span class="three-dots">⋮</span> de la esquina.</span>
            </div>
            <div class="step">
                <span class="step-number">2</span>
                <span>Selecciona "<b>Abrir en el navegador</b>".</span>
            </div>
        </div>
    </div>

    <div id="install-prompt">
        <span>Instala la aplicación para un acceso rápido</span>
        <button id="install-button">Instalar</button>
    </div>

    <main class="card-container">
        <div class="install-card">
            <img src="images/icons/icon192.png" alt="Logo de PhotoPea" class="app-icon">
            <h1>PhotoPea</h1>
            <h2 id="status-text">
                <span>Listo para instalar</span>
            </h2>
            <p class="instructions">
                Haz clic en el botón <strong>Instalar</strong> que aparece en la notificación superior para añadir la aplicación a tu dispositivo.
            </p>
        </div>
    </main>

    <script>
        const installPromptDiv=document.getElementById("install-prompt"),installButton=document.getElementById("install-button"),statusText=document.getElementById("status-text"),instructions=document.querySelector(".instructions"),modal=document.getElementById("pwa-modal");let deferredPrompt;const isMobileDevice=()=>{const e=navigator.userAgent||navigator.vendor||window.opera;return/Mobi|Android|iPhone|iPad|iPod|Tablet/i.test(e)};(()=>{const e=window.matchMedia("(display-mode: standalone)").matches;isMobileDevice()&&e&&(modal.style.display="flex",installPromptDiv.style.display="none",instructions.textContent="Sigue las instrucciones para poder instalar.")})(),window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),deferredPrompt=e,installPromptDiv.style.display="flex"}),installButton.addEventListener("click",async()=>{deferredPrompt&&(installPromptDiv.style.display="none",statusText.innerHTML='<div class="loader"></div><span>Instalando...</span>',instructions.style.display="none",deferredPrompt.prompt(),("dismissed"===(await deferredPrompt.userChoice).outcome&&(console.log("El usuario cancel\xF3 la instalaci\xF3n"),statusText.innerHTML="<span>Listo para instalar</span>",instructions.style.display="block"),deferredPrompt=null))}),window.addEventListener("appinstalled",()=>{console.log("PWA fue instalada con \xE9xito"),statusText.innerHTML="<span>\xA1Instalaci\xF3n completa!</span>",isMobileDevice()||setTimeout(()=>{window.location.href="index.html"},2e3)});
    </script>
</body>
</html>
